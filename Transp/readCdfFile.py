# -*- coding: utf-8 -*-
"""
Created on Fri Sep 27 15:59:30 2019

@author: normandy
"""

import numpy as np
import scipy.io
import matplotlib.pyplot as plt

# %%

data = scipy.io.netcdf.netcdf_file('/home/pablorf/Cao_transp/12345A05/12345A05.CDF')

roa = data.variables['RMNMP'].data/21.878
time = data.variables['TIME'].data

tind = np.searchsorted(time, 0.95)

volts = data.variables['V'].data

eta_snc = data.variables['ETA_SNC'].data
eta_sps = data.variables['ETA_SPS'].data
ft = data.variables['NCFT'].data
ftl = data.variables['NCFTMINUS'].data
ftu = data.variables['NCFTPLUS'].data
zeffc = data.variables['ZEFFC'].data
zeffp = data.variables['ZEFFP'].data

nuste = data.variables['NUSTE'].data
nusti = data.variables['NUSTI'].data

cloge = data.variables['CLOGE'].data
clogi = data.variables['CLOGI'].data

te = data.variables['TE'].data
ne = data.variables['NE'].data

# %%

roa_nc = [0.0518126756112,0.089743000264,0.115910092009,0.137214076245,0.15566733368,0.172198405757,0.187323221818,0.201360253687,0.214524406977,0.226967515469,0.23880240726,0.25011571052,0.260976920419,0.271441936587,0.281556175478,0.291357127544,0.300875800971,0.310138722704,0.319168688993,0.327984967858,0.336604868027,0.345043036835,0.353313179946,0.361427325914,0.369396499743,0.377230467367,0.384937866565,0.392526757282,0.400004278083,0.407376883949,0.414650580647,0.421830867536,0.428922707958,0.435930691203,0.442859086953,0.449711921049,0.456492995378,0.463205892687,0.469853954487,0.476440303707,0.482967870732,0.489439424237,0.49585754572,0.50222466287,0.508543065264,0.51481491546,0.521042256619,0.527227021802,0.533371045139,0.539476069524,0.545543752778,0.551575682723,0.5575733973,0.563538375409,0.569472030882,0.57537571683,0.581250730563,0.587098319884,0.59291968724,0.598715990681,0.604488346132,0.610237830315,0.615965483391,0.621672308988,0.627359276482,0.633027325189,0.638677366826,0.644310287154,0.6499269477,0.655528200929,0.661114894263,0.666687857086,0.672247899458,0.677795813972,0.683332376967,0.688858349868,0.694374480447,0.699881503761,0.705380143213,0.710871111552,0.716355111875,0.721832842671,0.727305006609,0.732772301514,0.738235419193,0.743695045607,0.749151866098,0.754606537707,0.760059637903,0.765511704281,0.770963273993,0.776414884596,0.78186707438,0.787320379611,0.792775325368,0.798232425877,0.803692198018,0.80915516105,0.81462183727,0.820092752374,0.82556841728,0.831049325591,0.836535973531,0.842028862348,0.847528500824,0.853035392747,0.858550172324,0.864073647473,0.869606688935,0.875150173406,0.880704996648,0.886272070971,0.891852347597,0.89744684345,0.903056616529,0.90868275005,0.914326357611,0.91998858475,0.925670652784,0.931373960328,0.937099997818,0.942850307061,0.948626491229,0.954430214244,0.960262888138,0.966124978875,0.972016739885,0.977938438416,0.983890343999,0.989872711576,0.995885472409]
eta_nc = [86564936.8618,78260354.6988,73684110.2487,70372306.775,67748453.5687,65591442.7403,63756765.7571,62046100.3841,60620132.6268,59194610.961,58001815.2388,56901174.6652,55885503.72,54891716.4108,54006172.6815,53156651.5147,52376502.2192,51603653.2399,50869608.3639,50175478.726,49540930.2378,48909941.3204,48291961.5616,47719655.1817,47125071.2159,46521272.8301,45950691.1095,45353271.6685,44767856.0268,44168860.8782,43550436.6926,42906345.8378,42275568.2983,41618007.2552,40958024.007,40276113.3956,39581963.7549,38870026.5451,38134251.0098,37395887.9308,36644669.0949,35883161.6251,35116582.1795,34347229.3712,33570890.4734,32787389.9179,32012578.4317,31246878.3659,30487037.2047,29737232.8749,28990529.4971,28254495.4665,27530932.7206,26810630.4766,26108063.465,25419491.9731,24741294.3178,24070791.473,23420417.6979,22783678.3999,22153398.3736,21537988.7148,20942713.6098,20356906.4208,19792008.7724,19233016.3253,18691589.6306,18164688.8237,17644117.0914,17136978.6075,16645836.3985,16162065.1995,15691755.0459,15229102.4492,14781572.883,14341149.3912,13910210.319,13489811.5011,13080465.9572,12678912.2471,12289611.9781,11908364.846,11536728.0461,11173208.0499,10817500.447,10470047.9646,10129218.9893,9797205.25999,9473352.12093,9153940.14923,8843398.82083,8539981.85376,8242763.16661,7951773.62758,7667671.58056,7390670.83929,7120067.36945,6855279.35579,6597142.18634,6344728.46682,6098254.71445,5856604.77042,5620074.53938,5390312.66534,5164951.09946,4944590.46789,4728341.68897,4519062.23112,4314052.08452,4112954.3974,3916050.70229,3725105.38225,3538113.39378,3355047.37329,3175274.21419,3001509.21015,2831072.76869,2663470.46412,2498637.75235,2339864.98732,2184216.29192,2030525.75922,1878664.2123,1732399.84764,1588613.48693,1445340.85074,1302729.76827,1176052.35036,1050695.94741,916669.162437,777572.507375]
ft_nc = [0.176629087665,0.239849979106,0.273120548736,0.297238154634,0.316359793092,0.331958707173,0.345183391426,0.358032938206,0.368378038254,0.37946876806,0.388379029287,0.396702679944,0.404458802571,0.412367286947,0.419315127707,0.426128664354,0.432356871463,0.438742880108,0.444839523738,0.450596327269,0.455724391117,0.46089581945,0.465942603849,0.470403351997,0.47511422923,0.47986151658,0.484068626688,0.488480546891,0.492525545374,0.496537843022,0.500575492465,0.504702186441,0.508322608905,0.51202834347,0.515479492771,0.518939045424,0.522280512006,0.52555650872,0.528918467055,0.532080708461,0.535217124709,0.53833014142,0.541370700658,0.54432780951,0.547302432082,0.550330072835,0.553207919933,0.555944492002,0.558621332074,0.561199352522,0.56383309577,0.566397428878,0.568876837488,0.571474581633,0.573936042797,0.576325882997,0.578728993126,0.581217321316,0.583532579328,0.585810315263,0.588221723551,0.590581672555,0.59279755417,0.595080450709,0.59713345921,0.599341371482,0.601426217081,0.603420999061,0.605555450781,0.607620907322,0.609565033982,0.611610018648,0.613551737728,0.61557283375,0.617449545064,0.619419573858,0.621385198375,0.623297485614,0.625164351973,0.627080256394,0.628838395349,0.630597485745,0.632321813607,0.634049257026,0.635758245276,0.637416842138,0.639147867906,0.640821640277,0.64241332105,0.644126283345,0.645740636707,0.647357284897,0.648967656135,0.650562157127,0.652131829024,0.653688700763,0.655178195159,0.656632510261,0.658017872327,0.659481962623,0.66085617045,0.66223164429,0.663606925999,0.664945840145,0.666291372304,0.667565781058,0.668886997237,0.670174814398,0.671416185612,0.67265048086,0.67382335784,0.675047401765,0.676189053291,0.677212277258,0.67822026023,0.67918099653,0.680085890008,0.680943278637,0.681755753989,0.682544230655,0.683213605956,0.683781053505,0.684275783738,0.684687206768,0.684913205354,0.684978577857,0.684809933089,0.684378284547,0.683449150308,0.681730525093,0.677242253499]
nustare = [1.085534703,0.482171089586,0.332554465072,0.261356690336,0.218780724058,0.190021936749,0.169217278822,0.15338936994,0.140937580094,0.130916009744,0.12260268332,0.115581336512,0.109575561,0.104408694375,0.0998760808899,0.0958650545198,0.0922935918709,0.0891196019811,0.0862578530643,0.0836668403965,0.0813148269323,0.0792018289957,0.0772778450104,0.0755275445224,0.0739348781403,0.072521686556,0.0712488203498,0.0701060078562,0.0690937456033,0.0682266840808,0.0674800251104,0.0668465848114,0.0663327100226,0.0659490223566,0.0656785030952,0.0655120711654,0.0654478304235,0.065509375217,0.0656784103246,0.0659425874462,0.0662996941591,0.0667658322603,0.0673346020119,0.0679893808295,0.0687278241638,0.0695657758328,0.0705008406542,0.0715123655766,0.0725983410937,0.0737722460005,0.0750431190884,0.0763841366884,0.0777940590441,0.0792851752681,0.0808781188383,0.0825388273099,0.0842671292217,0.0860659306606,0.0879452054807,0.0898936560649,0.0919122765467,0.0940125919922,0.0962866488354,0.0986390947133,0.101072352439,0.103589179562,0.106274841282,0.109053359917,0.111928715825,0.114905290488,0.118081672753,0.121382546414,0.124804299197,0.128353368755,0.132134810263,0.136084976444,0.140190151651,0.144459547318,0.149011190795,0.153795537222,0.158779997183,0.163979804039,0.169534470118,0.175417281965,0.181573010725,0.18802095099,0.194930152702,0.202316918316,0.210080102053,0.218248564029,0.22699733402,0.236415381543,0.246363524229,0.256886282839,0.26819985428,0.280531009238,0.293634713991,0.307582664482,0.322620616025,0.33921506533,0.35697746655,0.376028872418,0.396660745529,0.419752750787,0.444693745128,0.471700978736,0.501137292515,0.534942889956,0.571882868794,0.612384728869,0.656953629902,0.70893444087,0.766715722539,0.831136899865,0.90332108589,0.989367562745,1.08766394904,1.19987314288,1.3289011774,1.48999193392,1.68214893436,1.90953428737,2.18174402384,2.54152447332,3.00060639954,3.57752948467,4.31769124755,5.7155022483,7.98036375285,11.2183560494,16.0722272003]
#nustari = [2.71647521805,1.2008968551,0.82447389411,0.645155167528,0.538185283207,0.466358970266,0.414462031297,0.375067261342,0.344120198943,0.31920473073,0.298664468634,0.281456170647,0.266907209758,0.254619294224,0.244011525133,0.234785142149,0.226733380608,0.219767559377,0.213641539725,0.208272030692,0.203547232246,0.199495601818,0.195955250909,0.192879433217,0.190236015414,0.188069968939,0.186262527232,0.18479004417,0.183615957761,0.182792781978,0.182249808935,0.181957490192,0.181895404491,0.182123384428,0.182581367566,0.183238099002,0.184082923005,0.185173462346,0.186467986872,0.187922276534,0.1895290482,0.191346624602,0.19335400749,0.195492607216,0.19775631098,0.200198566776,0.2028222202,0.205555049961,0.208391763411,0.211382009461,0.214558447751,0.217825589932,0.221178967657,0.22466042167,0.228338980751,0.232093799523,0.235921385604,0.239854027866,0.244008751076,0.248230091628,0.252515767322,0.256884508288,0.261515764403,0.26620973618,0.270965578703,0.275782828628,0.280788499265,0.285857725088,0.290991303386,0.296190472436,0.301866773984,0.307661318679,0.313534767774,0.319490384821,0.325829265546,0.332332136082,0.338935996845,0.345646575431,0.35279928305,0.360207187205,0.367750639812,0.375438571986,0.383604143305,0.392135909963,0.400853666112,0.409770773652,0.419232340787,0.429224294225,0.439475723352,0.450006369935,0.461236194426,0.473316214535,0.485766325853,0.498616192635,0.512255665475,0.527062092436,0.542402512391,0.558322523511,0.575202963514,0.59378381644,0.613152327732,0.633381175352,0.654874559176,0.679185195166,0.70470489878,0.731556220715,0.760046152826,0.792748969264,0.827378893656,0.864155665676,0.90333193984,0.950052582002,1.00022799882,1.05413817825,1.11229141946,1.18137322865,1.25733796958,1.34027907919,1.43132822048,1.54397906573,1.67249189873,1.8160166146,1.97758317888,2.19186244312,2.45192517767,2.75255319412,3.10447727641,3.81124460955,4.87760101683,6.18364418923,7.82225673607]
sig_spitz = [98227230.9279,97622780.5729,97046882.7884,96495922.5769,95968111.1908,95463192.2076,94980573.3868,94519786.4551,94081233.2988,93664868.1368,93269952.2935,92896006.2003,92542137.9398,92207250.1443,91890746.4868,91589638.0829,91301565.9832,91025008.8453,90755653.2002,90490353.6882,90224722.9702,89954265.187,89674127.6588,89377820.96,89062211.9935,88717463.522,88340543.2796,87927483.9645,87466756.1655,86956789.8494,86395334.0097,85778634.7025,85093972.889,84348169.0936,83540180.0947,82669638.3804,81737060.1366,80736511.7163,79678068.8178,78565219.8228,77401754.2808,76191978.4934,74940594.3838,73652575.3483,72333042.2506,70985013.6684,69616459.901,68232214.7476,66836870.3675,65434725.215,64029747.0424,62625548.001,61225371.7011,59832095.9028,58448243.6258,57075998.6747,55717225.9532,54373494.7086,53046104.0338,51736109.6866,50444350.579,49171474.2829,47917961.3034,46684148.0606,45470247.621,44276368.1739,43102529.8104,41948679.5519,40814704.1759,39700439.8552,38605682.0419,37530196.281,36473726.3143,35436000.2844,34416735.9484,33415645.0212,32432436.7695,31466820.9977,30518510.4611,29587222.7978,28673009.7269,27775358.398,26893906.0312,26028398.5735,25178592.0983,24344253.0648,23525158.4767,22721100.1465,21931889.2292,21157351.1998,20397320.9136,19651641.8568,18920165.9953,18202753.9816,17499275.8636,16809610.8916,16133645.8847,15471274.9176,14822581.083,14187374.7612,13565472.1768,12956799.4094,12361288.8491,11778878.9205,11209514.0184,10653143.7179,10109712.4294,9579158.30512,9061422.62529,8556455.42012,8064215.81664,7584672.14546,7117800.87898,6663585.81279,6222020.50119,5793110.48801,5376874.20475,4973343.77306,4582563.86183,4204588.48516,3839488.81392,3487359.25342,3148320.73392,2822526.58034,2510183.4646,2211583.6268,1927073.4101,1657049.52962,1401974.28639,1162399.2024,939006.716946]
#lnLe = [15.986168113,15.9851074762,15.9841169868,15.9831335236,15.9821140407,15.9810190879,15.9798149113,15.9784559811,15.976912503,15.975146581,15.973120494,15.9707987816,15.9681495441,15.965145027,15.9617175529,15.9578771963,15.9535990223,15.948813894,15.9435766645,15.9377759521,15.9315009561,15.9246566582,15.9173029141,15.9094268423,15.9009926849,15.8920693541,15.8826439294,15.8726971293,15.8622964084,15.8514566134,15.8401742993,15.8284754747,15.8164042397,15.8039825824,15.7912333706,15.778175038,15.7648369922,15.7512495155,15.7374353219,15.7234165575,15.7092146219,15.6948500045,15.6803421464,15.66571922,15.6509930163,15.636176471,15.6212834317,15.606326435,15.5913167085,15.5762641919,15.5611775734,15.5460643314,15.5309307853,15.5157821922,15.5006228414,15.4854560656,15.4702842704,15.4551089935,15.4399309663,15.4247501813,15.4095659495,15.3943769441,15.3791812473,15.3639763959,15.3487594221,15.3335268805,15.3182748842,15.302999143,15.2876949924,15.2723574151,15.2569810733,15.2415604054,15.2260896119,15.2105626092,15.1949730223,15.1793141865,15.1635791531,15.1477607089,15.1318513643,15.1158433268,15.0997284839,15.0834983876,15.0671442265,15.0506567745,15.0340263635,15.0172428845,15.0002957609,14.9831739107,14.9658657624,14.9483593939,14.9306425466,14.9127023285,14.8945251138,14.8760964746,14.857401118,14.8384228583,14.8191445442,14.7995478767,14.7796132816,14.7593197734,14.7386448059,14.7175641233,14.6960515664,14.6740788192,14.6516151491,14.6286271058,14.6050781093,14.5809276674,14.5561309448,14.5306385037,14.5043956511,14.4773416524,14.4494087766,14.4205211118,14.3905932427,14.3595286535,14.3272177275,14.2935352493,14.258337008,14.2214555236,14.1826954518,14.1418274527,14.0985799685,14.0526292456,14.0035899367,13.9509968911,13.8942765929,13.8327181362,13.7654640256,13.6912793961,13.6085981923]
# %%

nuste_interp = np.interp(roa_nc, roa[tind,:], nuste[tind,:])
nusti_interp = np.interp(roa_nc, roa[tind,:], nusti[tind,:])


sps_interp = np.interp(roa_nc, roa[tind,:], eta_snc[tind,:])

print zeffc[tind]
plt.plot(roa_nc, 100.0/np.array(eta_nc)/sps_interp , c='g')

#plt.plot(roa[tind,:], ft[tind,:], c='b')
#plt.plot(roa_nc, ft_nc, c='g')


# %%

spitz_calc = 1.9012e4 * te**1.5 / zeffp / cloge

#plt.plot(roa[tind,:], eta_sps[tind,:])
plt.plot(roa[tind,:], 100.0/spitz_calc[tind,:]/eta_sps[tind,:])

# %%

plt.plot(roa[tind,:], te[tind,:])